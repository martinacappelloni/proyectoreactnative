{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { Camera } from 'expo-camera';\nimport { db, storage } from \"../firebase/config\";\n\nvar MyCamera = function (_Component) {\n  _inherits(MyCamera, _Component);\n\n  var _super = _createSuper(MyCamera);\n\n  function MyCamera(props) {\n    var _this;\n\n    _classCallCheck(this, MyCamera);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      permission: false,\n      photo: '',\n      showCamera: true\n    };\n    _this.camera;\n    return _this;\n  }\n\n  _createClass(MyCamera, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      Camera.requestCameraPermissionsAsync().then(function () {\n        _this2.setState({\n          permission: true\n        });\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    }\n  }, {\n    key: \"takePicture\",\n    value: function takePicture() {\n      var _this3 = this;\n\n      this.camera.takePictureAsync().then(function (photo) {\n        _this3.setState({\n          photo: photo.uri,\n          showCamera: false\n        });\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    }\n  }, {\n    key: \"savePhoto\",\n    value: function savePhoto() {\n      var _this4 = this;\n\n      fetch(this.state.photo).then(function (res) {\n        return res.blob();\n      }).then(function (image) {\n        var ref = storage.ref(\"photos/\" + Date.now() + \".jpg\");\n        ref.put(image).then(function () {\n          ref.getDownloadURL().then(function (url) {\n            _this4.props.onImageUpload(url);\n\n            _this4.setState({\n              photo: ''\n            });\n          }).catch(function (error) {\n            return console.log(error);\n          });\n        }).catch(function (error) {\n          return console.log(error);\n        });\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.setState({\n        photo: '',\n        showCamera: true\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return React.createElement(View, {\n        style: styles.container\n      }, this.state.permission ? this.state.showCamera === false ? React.createElement(React.Fragment, null, React.createElement(Image, {\n        style: styles.cameraBody,\n        source: {\n          uri: this.state.photo\n        }\n      }), React.createElement(View, null, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this5.savePhoto();\n        }\n      }, React.createElement(Text, null, \"Aceptar\")), React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this5.clear();\n        }\n      }, React.createElement(Text, null, \"Rechazar\")))) : React.createElement(View, {\n        style: styles.container\n      }, React.createElement(Camera, {\n        style: styles.cameraBody,\n        type: Camera.Constants.Type.back,\n        ref: function ref(reference) {\n          return _this5.camera = reference;\n        }\n      }), React.createElement(TouchableOpacity, {\n        style: styles.button,\n        onPress: function onPress() {\n          return _this5.takePicture();\n        }\n      }, React.createElement(Text, null, \"Sacar foto\"))) : React.createElement(Text, null, \"No tienes permisos para usar la camara\"));\n    }\n  }]);\n\n  return MyCamera;\n}(Component);\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  cameraBody: {\n    flex: 7\n  },\n  button: {\n    flex: 1,\n    justifyContent: 'center'\n  }\n});\nexport default MyCamera;","map":{"version":3,"sources":["/Users/morabaylac/Desktop/proyectoreactnative/src/components/MyCamera.js"],"names":["React","Component","Camera","db","storage","MyCamera","props","state","permission","photo","showCamera","camera","requestCameraPermissionsAsync","then","setState","catch","error","console","log","takePictureAsync","uri","fetch","res","blob","image","ref","Date","now","put","getDownloadURL","url","onImageUpload","styles","container","cameraBody","savePhoto","clear","Constants","Type","back","reference","button","takePicture","StyleSheet","create","flex","justifyContent"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;;;;;;AAEA,SAAQC,MAAR,QAAqB,aAArB;AACA,SAAQC,EAAR,EAAYC,OAAZ;;IAEMC,Q;;;;;AACF,oBAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AACd,8BAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACTC,MAAAA,UAAU,EAAE,KADH;AAETC,MAAAA,KAAK,EAAE,EAFE;AAGTC,MAAAA,UAAU,EAAE;AAHH,KAAb;AAKA,UAAKC,MAAL;AAPc;AAQjB;;;;WACD,6BAAmB;AAAA;;AACfT,MAAAA,MAAM,CAACU,6BAAP,GACKC,IADL,CACW,YAAI;AACP,QAAA,MAAI,CAACC,QAAL,CAAc;AACVN,UAAAA,UAAU,EAAE;AADF,SAAd;AAGH,OALL,EAMKO,KANL,CAMY,UAAAC,KAAK;AAAA,eAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ;AAAA,OANjB;AAWH;;;WAED,uBAAa;AAAA;;AACT,WAAKL,MAAL,CAAYQ,gBAAZ,GACKN,IADL,CACU,UAACJ,KAAD,EAAS;AACX,QAAA,MAAI,CAACK,QAAL,CAAc;AACVL,UAAAA,KAAK,EAAEA,KAAK,CAACW,GADH;AAEVV,UAAAA,UAAU,EAAE;AAFF,SAAd;AAIH,OANL,EAOKK,KAPL,CAOY,UAAAC,KAAK;AAAA,eAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ;AAAA,OAPjB;AAQH;;;WAED,qBAAW;AAAA;;AAEPK,MAAAA,KAAK,CAAC,KAAKd,KAAL,CAAWE,KAAZ,CAAL,CACKI,IADL,CACU,UAAAS,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,OADb,EAEKV,IAFL,CAEW,UAAAW,KAAK,EAAG;AAEX,YAAMC,GAAG,GAAGrB,OAAO,CAACqB,GAAR,aAAsBC,IAAI,CAACC,GAAL,EAAtB,UAAZ;AACAF,QAAAA,GAAG,CAACG,GAAJ,CAAQJ,KAAR,EACKX,IADL,CACU,YAAI;AACNY,UAAAA,GAAG,CAACI,cAAJ,GACKhB,IADL,CACW,UAAAiB,GAAG,EAAI;AACV,YAAA,MAAI,CAACxB,KAAL,CAAWyB,aAAX,CAAyBD,GAAzB;;AACA,YAAA,MAAI,CAAChB,QAAL,CAAc;AACVL,cAAAA,KAAK,EAAC;AADI,aAAd;AAGH,WANL,EAOKM,KAPL,CAOW,UAAAC,KAAK;AAAA,mBAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ;AAAA,WAPhB;AAQH,SAVL,EAWKD,KAXL,CAWW,UAAAC,KAAK;AAAA,iBAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ;AAAA,SAXhB;AAYC,OAjBT,EAkBKD,KAlBL,CAkBW,UAAAC,KAAK;AAAA,eAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ;AAAA,OAlBhB;AAmBH;;;WAED,iBAAO;AACH,WAAKF,QAAL,CAAc;AACVL,QAAAA,KAAK,EAAE,EADG;AAEVC,QAAAA,UAAU,EAAE;AAFF,OAAd;AAIH;;;WAED,kBAAQ;AAAA;;AACJ,aACI,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEsB,MAAM,CAACC;AAApB,SAEI,KAAK1B,KAAL,CAAWC,UAAX,GACI,KAAKD,KAAL,CAAWG,UAAX,KAA0B,KAA1B,GACA,oBAAC,KAAD,CAAO,QAAP,QACI,oBAAC,KAAD;AACI,QAAA,KAAK,EAAEsB,MAAM,CAACE,UADlB;AAEI,QAAA,MAAM,EAAE;AAACd,UAAAA,GAAG,EAAC,KAAKb,KAAL,CAAWE;AAAhB;AAFZ,QADJ,EAKI,oBAAC,IAAD,QACI,oBAAC,gBAAD;AAAkB,QAAA,OAAO,EAAE;AAAA,iBAAI,MAAI,CAAC0B,SAAL,EAAJ;AAAA;AAA3B,SACI,oBAAC,IAAD,kBADJ,CADJ,EAII,oBAAC,gBAAD;AAAkB,QAAA,OAAO,EAAE;AAAA,iBAAI,MAAI,CAACC,KAAL,EAAJ;AAAA;AAA3B,SACI,oBAAC,IAAD,mBADJ,CAJJ,CALJ,CADA,GAgBJ,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEJ,MAAM,CAACC;AAApB,SACI,oBAAC,MAAD;AACI,QAAA,KAAK,EAAED,MAAM,CAACE,UADlB;AAEI,QAAA,IAAI,EAAEhC,MAAM,CAACmC,SAAP,CAAiBC,IAAjB,CAAsBC,IAFhC;AAGI,QAAA,GAAG,EAAG,aAAAC,SAAS;AAAA,iBAAI,MAAI,CAAC7B,MAAL,GAAc6B,SAAlB;AAAA;AAHnB,QADJ,EAMI,oBAAC,gBAAD;AAAkB,QAAA,KAAK,EAAER,MAAM,CAACS,MAAhC;AAAwC,QAAA,OAAO,EAAE;AAAA,iBAAI,MAAI,CAACC,WAAL,EAAJ;AAAA;AAAjD,SACI,oBAAC,IAAD,qBADJ,CANJ,CAjBA,GA6BA,oBAAC,IAAD,iDA/BJ,CADJ;AAoCH;;;;EAtGkBzC,S;;AAyGvB,IAAM+B,MAAM,GAACW,UAAU,CAACC,MAAX,CAAkB;AAC3BX,EAAAA,SAAS,EAAC;AACNY,IAAAA,IAAI,EAAE;AADA,GADiB;AAI3BX,EAAAA,UAAU,EAAC;AACPW,IAAAA,IAAI,EAAE;AADC,GAJgB;AAO3BJ,EAAAA,MAAM,EAAC;AACHI,IAAAA,IAAI,EAAE,CADH;AAEHC,IAAAA,cAAc,EAAE;AAFb;AAPoB,CAAlB,CAAb;AAaA,eAAezC,QAAf","sourcesContent":["import React, {Component} from 'react';\nimport {View, Text, TouchableOpacity, StyleSheet, Image} from 'react-native';\nimport {Camera} from 'expo-camera';\nimport {db, storage} from '../firebase/config'; //conexion de base de datos y storage donde vamos a guardar las fotos\n\nclass MyCamera extends Component{\n    constructor(props){\n        super(props)\n        this.state = {\n            permission: false, //permisos de la camara en el dispositivo\n            photo: '', //guardar la url/uri de la foto\n            showCamera: true,\n        }\n        this.camera //la referencia a esta camara\n    }\n    componentDidMount(){\n        Camera.requestCameraPermissionsAsync()\n            .then (()=>{\n                this.setState({\n                    permission: true,\n                })\n            })\n            .catch( error => console.log(error))\n\n        //investigar\n        // console.log(Camera)\n        // console.log(this.camera)\n    }\n\n    takePicture(){\n        this.camera.takePictureAsync()\n            .then((photo)=>{\n                this.setState({\n                    photo: photo.uri, //la ruta interna temporal a la foto para mostrarsela al usuario\n                    showCamera: false,\n                })\n            })\n            .catch( error => console.log(error))\n    }\n\n    savePhoto(){\n        //Tiene que buscar la foto de la uri temporal y subirla al storage\n        fetch(this.state.photo)\n            .then(res => res.blob()) //blob es lo mismo que json pero cuando usas archivos binarios\n            .then( image =>{\n                //vamos a guardar la foto en storage de firebase y obtener la url publica\n                const ref = storage.ref(`photos/${Date.now()}.jpg`) //crear el nombre del archivo de la foto\n                ref.put(image)\n                    .then(()=>{\n                        ref.getDownloadURL()\n                            .then( url => {\n                                this.props.onImageUpload(url)\n                                this.setState({\n                                    photo:'',\n                                })\n                            })\n                            .catch(error => console.log(error))\n                    })\n                    .catch(error => console.log(error))\n                })\n            .catch(error => console.log(error))\n    }\n\n    clear(){\n        this.setState({\n            photo: '',\n            showCamera: true, \n        })\n    }\n\n    render(){\n        return(\n            <View style={styles.container}>\n            {\n                this.state.permission ?\n                    this.state.showCamera === false ?\n                    <React.Fragment>\n                        <Image\n                            style={styles.cameraBody}\n                            source={{uri:this.state.photo}}\n                        />\n                        <View>\n                            <TouchableOpacity onPress={()=>this.savePhoto()}>\n                                <Text>Aceptar</Text>\n                            </TouchableOpacity>\n                            <TouchableOpacity onPress={()=>this.clear()}> \n                                <Text>Rechazar</Text>\n                            </TouchableOpacity>\n                        </View>\n                    </React.Fragment> :\n                //render de la camara\n                <View style={styles.container}>\n                    <Camera \n                        style={styles.cameraBody}\n                        type={Camera.Constants.Type.back}\n                        ref={ reference => this.camera = reference}\n                    />\n                    <TouchableOpacity style={styles.button} onPress={()=>this.takePicture()}>\n                        <Text>Sacar foto</Text>\n                    </TouchableOpacity>\n                </View>\n                :\n                //render mensaje\n                <Text>No tienes permisos para usar la camara</Text>\n            }\n            </View>\n        )\n    }\n}\n\nconst styles=StyleSheet.create({\n    container:{\n        flex: 1,\n    },\n    cameraBody:{\n        flex: 7,\n    },\n    button:{\n        flex: 1,\n        justifyContent: 'center',\n    },\n})\n\nexport default MyCamera"]},"metadata":{},"sourceType":"module"}